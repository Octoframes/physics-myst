<!DOCTYPE html><html lang="en" class="light scroll-p-20"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>undefined - undefined</title><meta property="og:title" content="undefined - undefined"/><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="undefined - undefined"/><meta name="twitter:alt" content="undefined - undefined"/><link rel="stylesheet" href="/physicsmyst/build/_assets/app-GBHXBS6U.css"/><link rel="stylesheet" href="/physicsmyst/build/_assets/thebe-core-BKMFZL7Z.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 fixed w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-wrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="h-8 w-8 p-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 013.75 6h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 6.75zM3 12a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 12zm0 5.25a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75a.75.75 0 01-.75-.75z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center dark:text-white w-fit ml-3 md:ml-5 xl:ml-7" href="/physicsmyst/"><span class="text-md sm:text-xl tracking-tight sm:mr-5">Made with MyST</span></a></div><div class="flex-grow flex items-center w-auto"><div class="text-md flex-grow hidden lg:block"></div><div class="block flex-grow"></div><button class="theme rounded-full border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 mx-3 h-8 w-8" title="Change theme to dark mode." aria-label="Change theme to dark mode."><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="h-full w-full p-0.5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z"></path></svg></button><div class="block sm:hidden"><div class="relative" data-headlessui-state=""><div><button class="bg-transparent flex text-sm rounded-full focus:outline-none" id="headlessui-menu-button-:Rcikp:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Open Menu</span><div class="flex items-center text-stone-200 hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="h-8 w-8 p-1"><path fill-rule="evenodd" d="M10.5 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zm0 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zm0 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0z" clip-rule="evenodd"></path></svg></div></button></div></div></div><div class="hidden sm:block"><a href="https://myst.tools/docs/mystjs" target="_blank" rel="noopener noreferrer" class="inline-block text-md px-4 py-2 mx-1 leading-none border rounded border-stone-700 dark:border-white text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 hover:bg-neutral-100 mt-0">Learn More</a></div></div></nav></div><article class="article content article-grid article-grid-gap" style="margin-top:80px"><main class="article-grid article-subgrid-gap col-screen"><div class="mb-8"><div class="flex mt-3 mb-5 text-sm font-light items-center h-6"><div class="flex-grow"></div><a href="https://github.com/Octoframes/physicsmyst" title="GitHub Repository: Octoframes/physicsmyst" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="w-5 h-5 mr-1 inline-block opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="h-5 w-5 inline-block"><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><div class="flex relative grow-0 inline-block mx-1" data-headlessui-state=""><button class="relative" id="headlessui-menu-button-:R61b4p:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-5 h-5 ml-2 -mr-1"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div></div><div class="flex items-center"><div class="flex-grow"></div></div><div id="bMaKKwrI2Y" class="relative group/block article-grid article-subgrid-gap col-screen"><div id="nb-cell-0-a271f03367-code" class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">from typing import DefaultDict
from manim import *
import subprocess, sys
import numpy as np
import math

config.media_embed = True

from collections import defaultdict

#############################################
# Generalized N pendulum
#############################################
class Pendulum:
    def __init__(self, N, theta=None):
        self.N = N;
        self.gravity = 9.81
        self.L = np.ones(shape=(N, )) # lengths
        self.m = np.ones(shape=(N, )) # masses
        
        self.theta = np.zeros(shape=(N, )) if theta is None else theta
        self.theta_dot = np.zeros(shape=(N, ))

    def step(self, delta_t):
        equations = np.zeros(shape=(4 * self.N, 4 * self.N + 1))
        theta_dd = 0
        a_xn = theta_dd + self.N
        a_yn = a_xn + self.N
        T_n = a_yn + self.N
        for p in range(0, 4 * self.N, 4):
            n = p // 4
            # First equation x_dd
            equations[p, theta_dd + n] = self.L[n] * math.cos(self.theta[n])
            equations[p, a_xn + n] = -1.0;
            if n &gt; 0:
                equations[p, a_xn + n - 1] = 1
            equations[p, -1] = self.theta_dot[n]**2 * math.sin(self.theta[n])

            # Second equation y_dd
            equations[p + 1, theta_dd + n] = -1.0 * self.L[n] * math.sin(self.theta[n])
            equations[p + 1, a_yn + n] = -1.0
            if n &gt; 0:
                equations[p + 1, a_yn + n - 1] = 1.0
            equations[p + 1, -1] = self.theta_dot[n]**2 * math.cos(self.theta[n])

            # Third equation horizontal tension
            equations[p + 2, a_xn + n] = self.m[n]
            equations[p + 2, T_n + n] = math.sin(self.theta[n])
            if n + 1 &lt; self.N:
                equations[p + 2, T_n + n + 1] = -1.0 * math.sin(self.theta[n + 1])
            equations[p + 2, -1] = 0

            # Fourth equation vertical tension
            equations[p + 3, a_yn + n] = self.m[n]
            equations[p + 3, T_n + n] = math.cos(self.theta[n])
            if n + 1 &lt; self.N:
                equations[p + 3, T_n + n + 1] = -1.0 * math.cos(self.theta[n + 1])
            equations[p + 3, -1] = self.m[n] * self.gravity

        solution = np.linalg.solve(equations[:, 0:-1], equations[:, -1])
        self.theta_dot += delta_t * solution[0:self.N]
        self.theta += delta_t * self.theta_dot


class PhysicalNPendulum(Scene):
    def construct(self):
        p = Pendulum(N=2, theta=[math.pi / 2] * 2)
        scale = 2
        x_c, y_c = 0, 3

        def get_pendulum(dot_radius=DEFAULT_DOT_RADIUS):
            points = [[x_c, y_c, 0]] + [[scale * p.L[n] * math.sin(p.theta[n]), -scale * p.L[n] * math.cos(p.theta[n]), 0] for n in range(p.N)]
            for i in range(1, len(points)):
                for k in range(3):
                    points[i][k] += points[i - 1][k]
            return [ Line(points[i - 1], points[i]) for i in range(1, len(points)) ] + [ Dot(point, radius=dot_radius) for point in points]

        def step(pendulum, dt):
            for obj in pendulum:
                pendulum.remove(obj)
            p.step(dt / 2)
            for obj in get_pendulum(dot_radius=0.06):
                pendulum.add(obj)

        pendulum = VGroup()
        for obj in get_pendulum():
            pendulum.add(obj)
        pendulum.add_updater(step)
        self.add(pendulum)
        self.wait(5)
        pendulum.remove_updater(step)


param= &quot;-v WARNING  --progress_bar None   -r  500,200 --fps=3 --disable_caching PhysicalNPendulum&quot;
paramgif= &quot;-v WARNING  --progress_bar None --format=gif  -r  500,200  --disable_caching PhysicalNPendulum&quot;
%manim $param</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-0-a271f03367-output" data-mdast-node-type="output" data-mdast-node-id="PKlkbdjJS4" class="max-w-full overflow-visible m-0 group not-prose relative text-left"><div><div class="p-2.5">Loading...</div></div></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div class="flex space-x-4 pt-10 mb-10"><a class="group flex-1 p-4 block border font-normal hover:border-blue-600 dark:hover:border-blue-400 no-underline hover:text-blue-600 dark:hover:text-blue-400 text-gray-600 dark:text-gray-100 border-gray-200 dark:border-gray-500 rounded shadow-sm hover:shadow-lg dark:shadow-neutral-700" href="/physicsmyst/media-notebook"><div class="flex align-middle h-full"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-6 h-6 self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">Minimal Example</div>media-notebook</div></div></a><a class="group flex-1 p-4 block border font-normal hover:border-blue-600 dark:hover:border-blue-400 no-underline hover:text-blue-600 dark:hover:text-blue-400 text-gray-600 dark:text-gray-100 border-gray-200 dark:border-gray-500 rounded shadow-sm hover:shadow-lg dark:shadow-neutral-700" href="/physicsmyst/wave"><div class="flex align-middle h-full"><div class="flex-grow"><div class="text-xs text-gray-500 dark:text-gray-400">Minimal Example</div>wave</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-6 h-6 self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3"></path></svg></div></a></div><nav style="display:none"></nav></main></article><div class="fixed xl:article-grid article-grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><nav aria-label="Table of Contents" class="flex-grow overflow-y-auto transition-opacity mt-6 pb-3 ml-3 xl:ml-0 mr-3 max-w-[350px]"><ul class="space-y-6 lg:space-y-2"><li class="text-slate-900 leading-5 dark:text-slate-100 font-semibold"><a title="Minimal Example" class="block break-words mb-8 lg:mb-3 font-semibold text-slate-900 dark:text-slate-200 border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/physicsmyst/">Minimal Example</a></li><li class=""><a title="media-notebook" class="block break-words border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/physicsmyst/media-notebook">media-notebook</a></li><li class=""><a title="pendulum" class="block break-words border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/physicsmyst/pendulum">pendulum</a></li><li class=""><a title="wave" class="block break-words border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/physicsmyst/wave">wave</a></li></ul></nav><div class="flex-none py-4 opacity-0 transition-all duration-700 translate-y-6"><a class="flex w-fit mx-auto text-gray-700 hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://myst-tools.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center text-sm ml-2">Made with MyST</span></a></div></div></div><script>((u,f)=>{if(!window.history.state||!window.history.state.key){let m=Math.random().toString(32).slice(2);window.history.replaceState({key:m},"")}try{let b=JSON.parse(sessionStorage.getItem(u)||"{}")[f||window.history.state.key];typeof b=="number"&&window.scrollTo(0,b)}catch(m){console.error(m),sessionStorage.removeItem(u)}})("positions", null)</script><link rel="modulepreload" href="/physicsmyst/build/entry.client-ORTQVTK7.js"/><link rel="modulepreload" href="/physicsmyst/build/_shared/chunk-OLPNTUAB.js"/><link rel="modulepreload" href="/physicsmyst/build/_shared/chunk-RMYRWJKG.js"/><link rel="modulepreload" href="/physicsmyst/build/_shared/chunk-JCUQPVVQ.js"/><link rel="modulepreload" href="/physicsmyst/build/_shared/chunk-MS5GPXLY.js"/><link rel="modulepreload" href="/physicsmyst/build/_shared/chunk-C2JTSHFY.js"/><link rel="modulepreload" href="/physicsmyst/build/_shared/chunk-FELLYZ4U.js"/><link rel="modulepreload" href="/physicsmyst/build/_shared/chunk-QBZQYMPJ.js"/><link rel="modulepreload" href="/physicsmyst/build/_shared/chunk-E3SROWSD.js"/><link rel="modulepreload" href="/physicsmyst/build/_shared/chunk-PI7T3BDG.js"/><link rel="modulepreload" href="/physicsmyst/build/_shared/chunk-DU6O2KDC.js"/><link rel="modulepreload" href="/physicsmyst/build/_shared/chunk-STSN7GC4.js"/><link rel="modulepreload" href="/physicsmyst/build/_shared/chunk-ZQJ2EPTG.js"/><link rel="modulepreload" href="/physicsmyst/build/_shared/chunk-XIQ6U4TB.js"/><link rel="modulepreload" href="/physicsmyst/build/_shared/chunk-GTUSQ763.js"/><link rel="modulepreload" href="/physicsmyst/build/root-SUHMEADM.js"/><link rel="modulepreload" href="/physicsmyst/build/_shared/chunk-IXWKX6A7.js"/><link rel="modulepreload" href="/physicsmyst/build/routes/$-67EP337V.js"/><script>window.__remixContext = {"state":{"loaderData":{"root":{"theme":"light","config":{"myst":"v1","nav":[],"actions":[{"title":"Learn More","url":"https://myst.tools/docs/mystjs"}],"projects":[{"title":"Minimal Example","authors":[],"github":"https://github.com/Octoframes/physicsmyst","keywords":[],"bibliography":[],"index":"hello","pages":[{"slug":"media-notebook","title":"media-notebook","description":"","date":"","thumbnail":"","thumbnailOptimized":"","tags":[],"level":1},{"slug":"pendulum","title":"pendulum","description":"","date":"","thumbnail":"","thumbnailOptimized":"","tags":[],"level":1},{"slug":"wave","title":"wave","description":"","date":"","thumbnail":"","thumbnailOptimized":"","tags":[],"level":1}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/physicsmyst"},"routes/$":{"kind":"Notebook","sha256":"4d66790770fd327c78adaa8b93223a7c2d420a7ef3411368bb311dc4acf6838b","slug":"pendulum","dependencies":[],"frontmatter":{"authors":[],"github":"https://github.com/Octoframes/physicsmyst","keywords":[],"exports":[{"format":"ipynb","filename":"pendulum.ipynb","url":"/physicsmyst/build/pendulum-785ad6de355b7c4aafaacb222639eb40.ipynb"}]},"mdast":{"type":"root","children":[{"type":"block","position":{"start":{"line":0,"column":0},"end":{"line":1,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"from typing import DefaultDict\nfrom manim import *\nimport subprocess, sys\nimport numpy as np\nimport math\n\nconfig.media_embed = True\n\nfrom collections import defaultdict\n\n#############################################\n# Generalized N pendulum\n#############################################\nclass Pendulum:\n    def __init__(self, N, theta=None):\n        self.N = N;\n        self.gravity = 9.81\n        self.L = np.ones(shape=(N, )) # lengths\n        self.m = np.ones(shape=(N, )) # masses\n        \n        self.theta = np.zeros(shape=(N, )) if theta is None else theta\n        self.theta_dot = np.zeros(shape=(N, ))\n\n    def step(self, delta_t):\n        equations = np.zeros(shape=(4 * self.N, 4 * self.N + 1))\n        theta_dd = 0\n        a_xn = theta_dd + self.N\n        a_yn = a_xn + self.N\n        T_n = a_yn + self.N\n        for p in range(0, 4 * self.N, 4):\n            n = p // 4\n            # First equation x_dd\n            equations[p, theta_dd + n] = self.L[n] * math.cos(self.theta[n])\n            equations[p, a_xn + n] = -1.0;\n            if n \u003e 0:\n                equations[p, a_xn + n - 1] = 1\n            equations[p, -1] = self.theta_dot[n]**2 * math.sin(self.theta[n])\n\n            # Second equation y_dd\n            equations[p + 1, theta_dd + n] = -1.0 * self.L[n] * math.sin(self.theta[n])\n            equations[p + 1, a_yn + n] = -1.0\n            if n \u003e 0:\n                equations[p + 1, a_yn + n - 1] = 1.0\n            equations[p + 1, -1] = self.theta_dot[n]**2 * math.cos(self.theta[n])\n\n            # Third equation horizontal tension\n            equations[p + 2, a_xn + n] = self.m[n]\n            equations[p + 2, T_n + n] = math.sin(self.theta[n])\n            if n + 1 \u003c self.N:\n                equations[p + 2, T_n + n + 1] = -1.0 * math.sin(self.theta[n + 1])\n            equations[p + 2, -1] = 0\n\n            # Fourth equation vertical tension\n            equations[p + 3, a_yn + n] = self.m[n]\n            equations[p + 3, T_n + n] = math.cos(self.theta[n])\n            if n + 1 \u003c self.N:\n                equations[p + 3, T_n + n + 1] = -1.0 * math.cos(self.theta[n + 1])\n            equations[p + 3, -1] = self.m[n] * self.gravity\n\n        solution = np.linalg.solve(equations[:, 0:-1], equations[:, -1])\n        self.theta_dot += delta_t * solution[0:self.N]\n        self.theta += delta_t * self.theta_dot\n\n\nclass PhysicalNPendulum(Scene):\n    def construct(self):\n        p = Pendulum(N=2, theta=[math.pi / 2] * 2)\n        scale = 2\n        x_c, y_c = 0, 3\n\n        def get_pendulum(dot_radius=DEFAULT_DOT_RADIUS):\n            points = [[x_c, y_c, 0]] + [[scale * p.L[n] * math.sin(p.theta[n]), -scale * p.L[n] * math.cos(p.theta[n]), 0] for n in range(p.N)]\n            for i in range(1, len(points)):\n                for k in range(3):\n                    points[i][k] += points[i - 1][k]\n            return [ Line(points[i - 1], points[i]) for i in range(1, len(points)) ] + [ Dot(point, radius=dot_radius) for point in points]\n\n        def step(pendulum, dt):\n            for obj in pendulum:\n                pendulum.remove(obj)\n            p.step(dt / 2)\n            for obj in get_pendulum(dot_radius=0.06):\n                pendulum.add(obj)\n\n        pendulum = VGroup()\n        for obj in get_pendulum():\n            pendulum.add(obj)\n        pendulum.add_updater(step)\n        self.add(pendulum)\n        self.wait(5)\n        pendulum.remove_updater(step)\n\n\nparam= \"-v WARNING  --progress_bar None   -r  500,200 --fps=3 --disable_caching PhysicalNPendulum\"\nparamgif= \"-v WARNING  --progress_bar None --format=gif  -r  500,200  --disable_caching PhysicalNPendulum\"\n%manim $param","identifier":"nb-cell-0-a271f03367-code","enumerator":"1","html_id":"nb-cell-0-a271f03367-code","key":"xdElOaPa14"},{"type":"output","id":"fq7hby9I1qVtcHkKHESEy","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"\u003cvideo controls autoplay loop style=\"max-width: 60%;\"  \u003e\n \u003csource src=\"data:video/mp4;base64,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\" type=\"video/mp4\"\u003e\n Your browser does not support the video tag.\n \u003c/video\u003e","content_type":"text/html"},"text/plain":{"content":"\u003cIPython.core.display.Video object\u003e","content_type":"text/plain"}}}],"identifier":"nb-cell-0-a271f03367-output","html_id":"nb-cell-0-a271f03367-output","key":"PKlkbdjJS4"}],"data":{"id":"nb-cell-0-a271f03367","type":"notebook-code"},"identifier":"nb-cell-0-a271f03367","label":"nb-cell-0-a271f03367","html_id":"nb-cell-0-a271f03367","key":"bMaKKwrI2Y"}],"key":"vDDXFhPPvI"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"media-notebook","url":"/media-notebook","group":"Minimal Example"},"next":{"title":"wave","url":"/wave","group":"Minimal Example"}}},"domain":"http://localhost:3000"}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":false,"v2_headers":true,"v2_meta":false,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/physicsmyst/build/manifest-2FF8542C.js";
import * as route0 from "/physicsmyst/build/root-SUHMEADM.js";
import * as route1 from "/physicsmyst/build/routes/$-67EP337V.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/physicsmyst/build/entry.client-ORTQVTK7.js");</script></body></html>